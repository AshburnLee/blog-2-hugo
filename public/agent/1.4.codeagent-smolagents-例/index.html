<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>1.4.codeagent Smolagents 例 | Junhui&#39;s Journal 2</title>
<meta name="keywords" content="Agent, Smolagents">
<meta name="description" content="传统方法使用 JSON 格式来指定工具名称和参数作为字符串，系统必须解析以确定要执行哪个工具。工具调用型 LLM 与直接生成并执行代码更有效。这是 smolagents 的核心原则。
为什么 LLM 可以生成 code ？因为高质量的 code 已经在 LLM 的训练集中了。
使用 Code 而不是JSON 的优势是：

模块化地组合和重用
对象管理，直接处理复杂的结构
可以表达任何计算上的任务
充分利用了code 生成的能力

CodeAgent 是特殊的 MultiStepAgent
实例
准备好 HF access token: xxx
使用 HF serveless API 时最好设置 HF_TOKEN，但是对于公共的 models 和 datasets，是 optional 的。HF 中免费的API调用次数是有限的。需要付费。
他需要强大的可追溯性以供未来的监控和分析
代理本质上是不可预测且难以检查的。他需要可以被追溯从而，供监控和分析。有工具可以做， OpenTelemetry 和 Langfuse 用于跟踪和分析 Agents 的行为。
通过上述工具可以重新审视之前的 Agent 行为并进一步优化。
code
pip install smolagents -U
pip install duckduckgo-search
~~~def suggest_menu(occasion: str)

~~~py
# 登陆 HF
from huggingface_hub import notebook_login
notebook_login()  # 非nodetbook时 使用 login()

# 使用  DuckDuckGoSearchTool 搜索内容
from smolagents import CodeAgent, DuckDuckGoSearchTool, InferenceClientModel
agent = CodeAgent(tools=[DuckDuckGoSearchTool()], model=InferenceClientModel())
# 默认使用 InferenceClientModel - Qwen/Qwen2.5-Coder-32B-Instruct 
# 这个过程会执行多个Step，因为可以前面的Step中 生成的code有语法错误，Agent会自己修改
agent.run(&#34;Search for the best music recommendations for a party at the Wayne&#39;s mansion.&#34;)


from smolagents import CodeAgent, InferenceClientModel
import numpy as np
import time
import datetime

# 代码执行有严格的安全措施 - 默认情况下会阻止 predefined safe list 之外的导入。
# 但可以通过将它们作为字符串传递给 additional_authorized_imports 来授权额外的导入
agent = CodeAgent(tools=[], model=InferenceClientModel(), additional_authorized_imports=[&#39;datetime&#39;])

agent.run(
    &#34;&#34;&#34;
    Alfred needs to prepare for the party. Here are the tasks:
    1. Prepare the drinks - 30 minutes
    2. Decorate the mansion - 60 minutes
    3. Set up the menu - 45 minutes
    4. Prepare the music and playlist - 45 minutes

    If we start right now, at what time will the party be ready?
    &#34;&#34;&#34;
)

# push 到HF hub
# 改成你的 username/reponame
agent.push_to_hub(&#39;sergiopaniego/AlfredAgent&#39;)

# 加载 Agent，并让他工作
# 改成你的 username/reponame
alfred_agent = agent.from_hub(&#39;sergiopaniego/AlfredAgent&#39;, trust_remote_code=True)

alfred_agent.run(&#34;Give me the best playlist for a party at Wayne&#39;s mansion. \
                    The party idea is a &#39;villain masquerade&#39; theme&#34;)  
总之， smolagents 专门用于编写和执行 Python 代码片段，提供沙盒执行以保障安全。它支持本地和基于 API 的语言模型，使其能够适应各种开发环境。">
<meta name="author" content="">
<link rel="canonical" href="https://ashburnLee.github.io/blog-2-hugo/agent/1.4.codeagent-smolagents-%E4%BE%8B/">
<link crossorigin="anonymous" href="/blog-2-hugo/assets/css/stylesheet.bdaf5941cb3c05e36e857d9e2953ba0c4485ba7bc2da15db169d66a77cbc7a87.css" integrity="sha256-va9ZQcs8BeNuhX2eKVO6DESFunvC2hXbFp1mp3y8eoc=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://ashburnLee.github.io/blog-2-hugo/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ashburnLee.github.io/blog-2-hugo/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ashburnLee.github.io/blog-2-hugo/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ashburnLee.github.io/blog-2-hugo/apple-touch-icon.png">
<link rel="mask-icon" href="https://ashburnLee.github.io/blog-2-hugo/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://ashburnLee.github.io/blog-2-hugo/agent/1.4.codeagent-smolagents-%E4%BE%8B/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" id="MathJax-script" async></script>


<meta property="og:url" content="https://ashburnLee.github.io/blog-2-hugo/agent/1.4.codeagent-smolagents-%E4%BE%8B/">
  <meta property="og:site_name" content="Junhui&#39;s Journal 2">
  <meta property="og:title" content="1.4.codeagent Smolagents 例">
  <meta property="og:description" content="传统方法使用 JSON 格式来指定工具名称和参数作为字符串，系统必须解析以确定要执行哪个工具。工具调用型 LLM 与直接生成并执行代码更有效。这是 smolagents 的核心原则。
为什么 LLM 可以生成 code ？因为高质量的 code 已经在 LLM 的训练集中了。
使用 Code 而不是JSON 的优势是：
模块化地组合和重用 对象管理，直接处理复杂的结构 可以表达任何计算上的任务 充分利用了code 生成的能力 CodeAgent 是特殊的 MultiStepAgent
实例 准备好 HF access token: xxx
使用 HF serveless API 时最好设置 HF_TOKEN，但是对于公共的 models 和 datasets，是 optional 的。HF 中免费的API调用次数是有限的。需要付费。
他需要强大的可追溯性以供未来的监控和分析 代理本质上是不可预测且难以检查的。他需要可以被追溯从而，供监控和分析。有工具可以做， OpenTelemetry 和 Langfuse 用于跟踪和分析 Agents 的行为。
通过上述工具可以重新审视之前的 Agent 行为并进一步优化。
code pip install smolagents -U pip install duckduckgo-search ~~~def suggest_menu(occasion: str) ~~~py # 登陆 HF from huggingface_hub import notebook_login notebook_login() # 非nodetbook时 使用 login() # 使用 DuckDuckGoSearchTool 搜索内容 from smolagents import CodeAgent, DuckDuckGoSearchTool, InferenceClientModel agent = CodeAgent(tools=[DuckDuckGoSearchTool()], model=InferenceClientModel()) # 默认使用 InferenceClientModel - Qwen/Qwen2.5-Coder-32B-Instruct # 这个过程会执行多个Step，因为可以前面的Step中 生成的code有语法错误，Agent会自己修改 agent.run(&#34;Search for the best music recommendations for a party at the Wayne&#39;s mansion.&#34;) from smolagents import CodeAgent, InferenceClientModel import numpy as np import time import datetime # 代码执行有严格的安全措施 - 默认情况下会阻止 predefined safe list 之外的导入。 # 但可以通过将它们作为字符串传递给 additional_authorized_imports 来授权额外的导入 agent = CodeAgent(tools=[], model=InferenceClientModel(), additional_authorized_imports=[&#39;datetime&#39;]) agent.run( &#34;&#34;&#34; Alfred needs to prepare for the party. Here are the tasks: 1. Prepare the drinks - 30 minutes 2. Decorate the mansion - 60 minutes 3. Set up the menu - 45 minutes 4. Prepare the music and playlist - 45 minutes If we start right now, at what time will the party be ready? &#34;&#34;&#34; ) # push 到HF hub # 改成你的 username/reponame agent.push_to_hub(&#39;sergiopaniego/AlfredAgent&#39;) # 加载 Agent，并让他工作 # 改成你的 username/reponame alfred_agent = agent.from_hub(&#39;sergiopaniego/AlfredAgent&#39;, trust_remote_code=True) alfred_agent.run(&#34;Give me the best playlist for a party at Wayne&#39;s mansion. \ The party idea is a &#39;villain masquerade&#39; theme&#34;) 总之， smolagents 专门用于编写和执行 Python 代码片段，提供沙盒执行以保障安全。它支持本地和基于 API 的语言模型，使其能够适应各种开发环境。">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="agent">
    <meta property="article:published_time" content="2025-08-31T12:13:27+08:00">
    <meta property="article:modified_time" content="2025-08-31T12:13:27+08:00">
    <meta property="article:tag" content="Agent">
    <meta property="article:tag" content="Smolagents">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1.4.codeagent Smolagents 例">
<meta name="twitter:description" content="传统方法使用 JSON 格式来指定工具名称和参数作为字符串，系统必须解析以确定要执行哪个工具。工具调用型 LLM 与直接生成并执行代码更有效。这是 smolagents 的核心原则。
为什么 LLM 可以生成 code ？因为高质量的 code 已经在 LLM 的训练集中了。
使用 Code 而不是JSON 的优势是：

模块化地组合和重用
对象管理，直接处理复杂的结构
可以表达任何计算上的任务
充分利用了code 生成的能力

CodeAgent 是特殊的 MultiStepAgent
实例
准备好 HF access token: xxx
使用 HF serveless API 时最好设置 HF_TOKEN，但是对于公共的 models 和 datasets，是 optional 的。HF 中免费的API调用次数是有限的。需要付费。
他需要强大的可追溯性以供未来的监控和分析
代理本质上是不可预测且难以检查的。他需要可以被追溯从而，供监控和分析。有工具可以做， OpenTelemetry 和 Langfuse 用于跟踪和分析 Agents 的行为。
通过上述工具可以重新审视之前的 Agent 行为并进一步优化。
code
pip install smolagents -U
pip install duckduckgo-search
~~~def suggest_menu(occasion: str)

~~~py
# 登陆 HF
from huggingface_hub import notebook_login
notebook_login()  # 非nodetbook时 使用 login()

# 使用  DuckDuckGoSearchTool 搜索内容
from smolagents import CodeAgent, DuckDuckGoSearchTool, InferenceClientModel
agent = CodeAgent(tools=[DuckDuckGoSearchTool()], model=InferenceClientModel())
# 默认使用 InferenceClientModel - Qwen/Qwen2.5-Coder-32B-Instruct 
# 这个过程会执行多个Step，因为可以前面的Step中 生成的code有语法错误，Agent会自己修改
agent.run(&#34;Search for the best music recommendations for a party at the Wayne&#39;s mansion.&#34;)


from smolagents import CodeAgent, InferenceClientModel
import numpy as np
import time
import datetime

# 代码执行有严格的安全措施 - 默认情况下会阻止 predefined safe list 之外的导入。
# 但可以通过将它们作为字符串传递给 additional_authorized_imports 来授权额外的导入
agent = CodeAgent(tools=[], model=InferenceClientModel(), additional_authorized_imports=[&#39;datetime&#39;])

agent.run(
    &#34;&#34;&#34;
    Alfred needs to prepare for the party. Here are the tasks:
    1. Prepare the drinks - 30 minutes
    2. Decorate the mansion - 60 minutes
    3. Set up the menu - 45 minutes
    4. Prepare the music and playlist - 45 minutes

    If we start right now, at what time will the party be ready?
    &#34;&#34;&#34;
)

# push 到HF hub
# 改成你的 username/reponame
agent.push_to_hub(&#39;sergiopaniego/AlfredAgent&#39;)

# 加载 Agent，并让他工作
# 改成你的 username/reponame
alfred_agent = agent.from_hub(&#39;sergiopaniego/AlfredAgent&#39;, trust_remote_code=True)

alfred_agent.run(&#34;Give me the best playlist for a party at Wayne&#39;s mansion. \
                    The party idea is a &#39;villain masquerade&#39; theme&#34;)  
总之， smolagents 专门用于编写和执行 Python 代码片段，提供沙盒执行以保障安全。它支持本地和基于 API 的语言模型，使其能够适应各种开发环境。">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Agent",
      "item": "https://ashburnLee.github.io/blog-2-hugo/agent/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "1.4.codeagent Smolagents 例",
      "item": "https://ashburnLee.github.io/blog-2-hugo/agent/1.4.codeagent-smolagents-%E4%BE%8B/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "1.4.codeagent Smolagents 例",
  "name": "1.4.codeagent Smolagents 例",
  "description": "传统方法使用 JSON 格式来指定工具名称和参数作为字符串，系统必须解析以确定要执行哪个工具。工具调用型 LLM 与直接生成并执行代码更有效。这是 smolagents 的核心原则。\n为什么 LLM 可以生成 code ？因为高质量的 code 已经在 LLM 的训练集中了。\n使用 Code 而不是JSON 的优势是：\n模块化地组合和重用 对象管理，直接处理复杂的结构 可以表达任何计算上的任务 充分利用了code 生成的能力 CodeAgent 是特殊的 MultiStepAgent\n实例 准备好 HF access token: xxx\n使用 HF serveless API 时最好设置 HF_TOKEN，但是对于公共的 models 和 datasets，是 optional 的。HF 中免费的API调用次数是有限的。需要付费。\n他需要强大的可追溯性以供未来的监控和分析 代理本质上是不可预测且难以检查的。他需要可以被追溯从而，供监控和分析。有工具可以做， OpenTelemetry 和 Langfuse 用于跟踪和分析 Agents 的行为。\n通过上述工具可以重新审视之前的 Agent 行为并进一步优化。\ncode pip install smolagents -U pip install duckduckgo-search ~~~def suggest_menu(occasion: str) ~~~py # 登陆 HF from huggingface_hub import notebook_login notebook_login() # 非nodetbook时 使用 login() # 使用 DuckDuckGoSearchTool 搜索内容 from smolagents import CodeAgent, DuckDuckGoSearchTool, InferenceClientModel agent = CodeAgent(tools=[DuckDuckGoSearchTool()], model=InferenceClientModel()) # 默认使用 InferenceClientModel - Qwen/Qwen2.5-Coder-32B-Instruct # 这个过程会执行多个Step，因为可以前面的Step中 生成的code有语法错误，Agent会自己修改 agent.run(\u0026#34;Search for the best music recommendations for a party at the Wayne\u0026#39;s mansion.\u0026#34;) from smolagents import CodeAgent, InferenceClientModel import numpy as np import time import datetime # 代码执行有严格的安全措施 - 默认情况下会阻止 predefined safe list 之外的导入。 # 但可以通过将它们作为字符串传递给 additional_authorized_imports 来授权额外的导入 agent = CodeAgent(tools=[], model=InferenceClientModel(), additional_authorized_imports=[\u0026#39;datetime\u0026#39;]) agent.run( \u0026#34;\u0026#34;\u0026#34; Alfred needs to prepare for the party. Here are the tasks: 1. Prepare the drinks - 30 minutes 2. Decorate the mansion - 60 minutes 3. Set up the menu - 45 minutes 4. Prepare the music and playlist - 45 minutes If we start right now, at what time will the party be ready? \u0026#34;\u0026#34;\u0026#34; ) # push 到HF hub # 改成你的 username/reponame agent.push_to_hub(\u0026#39;sergiopaniego/AlfredAgent\u0026#39;) # 加载 Agent，并让他工作 # 改成你的 username/reponame alfred_agent = agent.from_hub(\u0026#39;sergiopaniego/AlfredAgent\u0026#39;, trust_remote_code=True) alfred_agent.run(\u0026#34;Give me the best playlist for a party at Wayne\u0026#39;s mansion. \\ The party idea is a \u0026#39;villain masquerade\u0026#39; theme\u0026#34;) 总之， smolagents 专门用于编写和执行 Python 代码片段，提供沙盒执行以保障安全。它支持本地和基于 API 的语言模型，使其能够适应各种开发环境。\n",
  "keywords": [
    "Agent", "Smolagents"
  ],
  "articleBody": "传统方法使用 JSON 格式来指定工具名称和参数作为字符串，系统必须解析以确定要执行哪个工具。工具调用型 LLM 与直接生成并执行代码更有效。这是 smolagents 的核心原则。\n为什么 LLM 可以生成 code ？因为高质量的 code 已经在 LLM 的训练集中了。\n使用 Code 而不是JSON 的优势是：\n模块化地组合和重用 对象管理，直接处理复杂的结构 可以表达任何计算上的任务 充分利用了code 生成的能力 CodeAgent 是特殊的 MultiStepAgent\n实例 准备好 HF access token: xxx\n使用 HF serveless API 时最好设置 HF_TOKEN，但是对于公共的 models 和 datasets，是 optional 的。HF 中免费的API调用次数是有限的。需要付费。\n他需要强大的可追溯性以供未来的监控和分析 代理本质上是不可预测且难以检查的。他需要可以被追溯从而，供监控和分析。有工具可以做， OpenTelemetry 和 Langfuse 用于跟踪和分析 Agents 的行为。\n通过上述工具可以重新审视之前的 Agent 行为并进一步优化。\ncode pip install smolagents -U pip install duckduckgo-search ~~~def suggest_menu(occasion: str) ~~~py # 登陆 HF from huggingface_hub import notebook_login notebook_login() # 非nodetbook时 使用 login() # 使用 DuckDuckGoSearchTool 搜索内容 from smolagents import CodeAgent, DuckDuckGoSearchTool, InferenceClientModel agent = CodeAgent(tools=[DuckDuckGoSearchTool()], model=InferenceClientModel()) # 默认使用 InferenceClientModel - Qwen/Qwen2.5-Coder-32B-Instruct # 这个过程会执行多个Step，因为可以前面的Step中 生成的code有语法错误，Agent会自己修改 agent.run(\"Search for the best music recommendations for a party at the Wayne's mansion.\") from smolagents import CodeAgent, InferenceClientModel import numpy as np import time import datetime # 代码执行有严格的安全措施 - 默认情况下会阻止 predefined safe list 之外的导入。 # 但可以通过将它们作为字符串传递给 additional_authorized_imports 来授权额外的导入 agent = CodeAgent(tools=[], model=InferenceClientModel(), additional_authorized_imports=['datetime']) agent.run( \"\"\" Alfred needs to prepare for the party. Here are the tasks: 1. Prepare the drinks - 30 minutes 2. Decorate the mansion - 60 minutes 3. Set up the menu - 45 minutes 4. Prepare the music and playlist - 45 minutes If we start right now, at what time will the party be ready? \"\"\" ) # push 到HF hub # 改成你的 username/reponame agent.push_to_hub('sergiopaniego/AlfredAgent') # 加载 Agent，并让他工作 # 改成你的 username/reponame alfred_agent = agent.from_hub('sergiopaniego/AlfredAgent', trust_remote_code=True) alfred_agent.run(\"Give me the best playlist for a party at Wayne's mansion. \\ The party idea is a 'villain masquerade' theme\") 总之， smolagents 专门用于编写和执行 Python 代码片段，提供沙盒执行以保障安全。它支持本地和基于 API 的语言模型，使其能够适应各种开发环境。\nfrom smolagents import CodeAgent, DuckDuckGoSearchTool, FinalAnswerTool, InferenceClientModel, Tool, tool, VisitWebpageTool @tool def suggest_menu(occasion: str) -\u003e str: \"\"\" Suggests a menu based on the occasion. Args: occasion: The type of occasion for the party. \"\"\" if occasion == \"casual\": return \"Pizza, snacks, and drinks.\" elif occasion == \"formal\": return \"3-course dinner with wine and dessert.\" elif occasion == \"superhero\": return \"Buffet with high-energy and healthy food.\" else: return \"Custom menu for the butler.\" @tool def catering_service_tool(query: str) -\u003e str: \"\"\" This tool returns the highest-rated catering service in Gotham City. Args: query: A search term for finding catering services. \"\"\" # Example list of catering services and their ratings services = { \"Gotham Catering Co.\": 4.9, \"Wayne Manor Catering\": 4.8, \"Gotham City Events\": 4.7, } # Find the highest rated catering service (simulating search query filtering) best_service = max(services, key=services.get) return best_service class SuperheroPartyThemeTool(Tool): name = \"superhero_party_theme_generator\" description = \"\"\" This tool suggests creative superhero-themed party ideas based on a category. It returns a unique party theme idea.\"\"\" inputs = { \"category\": { \"type\": \"string\", \"description\": \"The type of superhero party (e.g., 'classic heroes', 'villain masquerade', 'futuristic Gotham').\", } } output_type = \"string\" def forward(self, category: str): themes = { \"classic heroes\": \"Justice League Gala: Guests come dressed as their favorite DC heroes with themed cocktails like 'The Kryptonite Punch'.\", \"villain masquerade\": \"Gotham Rogues' Ball: A mysterious masquerade where guests dress as classic Batman villains.\", \"futuristic Gotham\": \"Neo-Gotham Night: A cyberpunk-style party inspired by Batman Beyond, with neon decorations and futuristic gadgets.\" } return themes.get(category.lower(), \"Themed party idea not found. Try 'classic heroes', 'villain masquerade', or 'futuristic Gotham'.\") # Alfred, the butler, preparing the menu for the party agent = CodeAgent( tools=[ DuckDuckGoSearchTool(), VisitWebpageTool(), suggest_menu, catering_service_tool, SuperheroPartyThemeTool(), FinalAnswerTool() ], model=InferenceClientModel(), max_steps=10, verbosity_level=2 ) agent.run(\"Give me the best playlist for a party at the Wayne's mansion. The party idea is a 'villain masquerade' theme\") 使用 OpenTelemetry and Langfuse 检测\n# !pip install smolagents[telemetry] \\ # opentelemetry-sdk \\ # opentelemetry-exporter-otlp \\ # openinference-instrumentation-smolagents import os import base64 from google.colab import userdata LANGFUSE_PUBLIC_KEY=userdata.get(\"LANGFUSE_PUBLIC_KEY\") LANGFUSE_SECRET_KEY=userdata.get(\"LANGFUSE_SECRET_KEY\") LANGFUSE_AUTH=base64.b64encode(f\"{LANGFUSE_PUBLIC_KEY}:{LANGFUSE_SECRET_KEY}\".encode()).decode() os.environ[\"OTEL_EXPORTER_OTLP_ENDPOINT\"] = \"https://cloud.langfuse.com/api/public/otel\" # EU data region # os.environ[\"OTEL_EXPORTER_OTLP_ENDPOINT\"] = \"https://us.cloud.langfuse.com/api/public/otel\" # US data region os.environ[\"OTEL_EXPORTER_OTLP_HEADERS\"] = f\"Authorization=Basic {LANGFUSE_AUTH}\" from smolagents import CodeAgent, InferenceClientModel agent = CodeAgent(tools=[], model=InferenceClientModel()) alfred_agent = agent.from_hub('sergiopaniego/AlfredAgent', trust_remote_code=True) alfred_agent.run(\"Give me best playlist for a party at the Wayne's mansion. The party idea is a 'villain masquerade' theme\") ",
  "wordCount" : "642",
  "inLanguage": "en",
  "datePublished": "2025-08-31T12:13:27+08:00",
  "dateModified": "2025-08-31T12:13:27+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ashburnLee.github.io/blog-2-hugo/agent/1.4.codeagent-smolagents-%E4%BE%8B/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Junhui's Journal 2",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ashburnLee.github.io/blog-2-hugo/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ashburnLee.github.io/blog-2-hugo/" accesskey="h" title="Junhui&#39;s Journal 2 (Alt + H)">Junhui&#39;s Journal 2</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ashburnLee.github.io/blog-2-hugo/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://ashburnLee.github.io/blog-2-hugo/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://ashburnLee.github.io/blog-2-hugo/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      1.4.codeagent Smolagents 例
    </h1>
    <div class="post-meta"><span title='2025-08-31 12:13:27 +0800 CST'>August 31, 2025</span>

</div>
  </header> 
  <div class="post-content"><p>传统方法使用 JSON 格式来指定工具名称和参数作为字符串，系统必须解析以确定要执行哪个工具。工具调用型 LLM 与直接生成并执行代码更有效。这是 smolagents 的核心原则。</p>
<p>为什么 LLM 可以生成 code ？因为高质量的 code 已经在 LLM 的训练集中了。</p>
<p>使用 Code 而不是JSON 的优势是：</p>
<ul>
<li>模块化地组合和重用</li>
<li>对象管理，直接处理复杂的结构</li>
<li>可以表达任何计算上的任务</li>
<li>充分利用了code 生成的能力</li>
</ul>
<p>CodeAgent 是特殊的 MultiStepAgent</p>
<h2 id="实例">实例<a hidden class="anchor" aria-hidden="true" href="#实例">#</a></h2>
<p>准备好 HF access token: xxx</p>
<p>使用 HF serveless API 时最好设置 <code>HF_TOKEN</code>，但是对于公共的 models 和 datasets，是 optional 的。HF 中免费的API调用次数是有限的。需要付费。</p>
<h2 id="他需要强大的可追溯性以供未来的监控和分析">他需要强大的可追溯性以供未来的监控和分析<a hidden class="anchor" aria-hidden="true" href="#他需要强大的可追溯性以供未来的监控和分析">#</a></h2>
<p>代理本质上是不可预测且难以检查的。他需要可以被追溯从而，供监控和分析。有工具可以做， <strong>OpenTelemetry</strong> 和 <strong>Langfuse</strong> 用于跟踪和分析 Agents 的行为。</p>
<p>通过上述工具可以重新审视之前的 Agent 行为并进一步优化。</p>
<h1 id="code">code<a hidden class="anchor" aria-hidden="true" href="#code">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>pip install smolagents -U
</span></span><span style="display:flex;"><span>pip install duckduckgo-search
</span></span><span style="display:flex;"><span>~~~def suggest_menu<span style="color:#f92672">(</span>occasion: str<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>~~~py
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 登陆 HF</span>
</span></span><span style="display:flex;"><span>from huggingface_hub import notebook_login
</span></span><span style="display:flex;"><span>notebook_login<span style="color:#f92672">()</span>  <span style="color:#75715e"># 非nodetbook时 使用 login()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 使用  DuckDuckGoSearchTool 搜索内容</span>
</span></span><span style="display:flex;"><span>from smolagents import CodeAgent, DuckDuckGoSearchTool, InferenceClientModel
</span></span><span style="display:flex;"><span>agent <span style="color:#f92672">=</span> CodeAgent<span style="color:#f92672">(</span>tools<span style="color:#f92672">=[</span>DuckDuckGoSearchTool<span style="color:#f92672">()]</span>, model<span style="color:#f92672">=</span>InferenceClientModel<span style="color:#f92672">())</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 默认使用 InferenceClientModel - Qwen/Qwen2.5-Coder-32B-Instruct </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 这个过程会执行多个Step，因为可以前面的Step中 生成的code有语法错误，Agent会自己修改</span>
</span></span><span style="display:flex;"><span>agent.run<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Search for the best music recommendations for a party at the Wayne&#39;s mansion.&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>from smolagents import CodeAgent, InferenceClientModel
</span></span><span style="display:flex;"><span>import numpy as np
</span></span><span style="display:flex;"><span>import time
</span></span><span style="display:flex;"><span>import datetime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 代码执行有严格的安全措施 - 默认情况下会阻止 predefined safe list 之外的导入。</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 但可以通过将它们作为字符串传递给 additional_authorized_imports 来授权额外的导入</span>
</span></span><span style="display:flex;"><span>agent <span style="color:#f92672">=</span> CodeAgent<span style="color:#f92672">(</span>tools<span style="color:#f92672">=[]</span>, model<span style="color:#f92672">=</span>InferenceClientModel<span style="color:#f92672">()</span>, additional_authorized_imports<span style="color:#f92672">=[</span><span style="color:#e6db74">&#39;datetime&#39;</span><span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>agent.run<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Alfred needs to prepare for the party. Here are the tasks:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    1. Prepare the drinks - 30 minutes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    2. Decorate the mansion - 60 minutes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    3. Set up the menu - 45 minutes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    4. Prepare the music and playlist - 45 minutes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    If we start right now, at what time will the party be ready?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># push 到HF hub</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 改成你的 username/reponame</span>
</span></span><span style="display:flex;"><span>agent.push_to_hub<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;sergiopaniego/AlfredAgent&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 加载 Agent，并让他工作</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 改成你的 username/reponame</span>
</span></span><span style="display:flex;"><span>alfred_agent <span style="color:#f92672">=</span> agent.from_hub<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;sergiopaniego/AlfredAgent&#39;</span>, trust_remote_code<span style="color:#f92672">=</span>True<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>alfred_agent.run<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Give me the best playlist for a party at Wayne&#39;s mansion. \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    The party idea is a &#39;villain masquerade&#39; theme&#34;</span><span style="color:#f92672">)</span>  
</span></span></code></pre></div><p>总之， smolagents 专门用于编写和执行 Python 代码片段，提供沙盒执行以保障安全。它支持本地和基于 API 的语言模型，使其能够适应各种开发环境。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> smolagents <span style="color:#f92672">import</span> CodeAgent, DuckDuckGoSearchTool, FinalAnswerTool, InferenceClientModel, Tool, tool, VisitWebpageTool
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@tool</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">suggest_menu</span>(occasion: str) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Suggests a menu based on the occasion.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        occasion: The type of occasion for the party.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> occasion <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;casual&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Pizza, snacks, and drinks.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> occasion <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;formal&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;3-course dinner with wine and dessert.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> occasion <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;superhero&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Buffet with high-energy and healthy food.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Custom menu for the butler.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@tool</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">catering_service_tool</span>(query: str) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This tool returns the highest-rated catering service in Gotham City.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        query: A search term for finding catering services.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Example list of catering services and their ratings</span>
</span></span><span style="display:flex;"><span>    services <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Gotham Catering Co.&#34;</span>: <span style="color:#ae81ff">4.9</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Wayne Manor Catering&#34;</span>: <span style="color:#ae81ff">4.8</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Gotham City Events&#34;</span>: <span style="color:#ae81ff">4.7</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Find the highest rated catering service (simulating search query filtering)</span>
</span></span><span style="display:flex;"><span>    best_service <span style="color:#f92672">=</span> max(services, key<span style="color:#f92672">=</span>services<span style="color:#f92672">.</span>get)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> best_service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SuperheroPartyThemeTool</span>(Tool):
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;superhero_party_theme_generator&#34;</span>
</span></span><span style="display:flex;"><span>    description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This tool suggests creative superhero-themed party ideas based on a category.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    It returns a unique party theme idea.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    inputs <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;category&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;The type of superhero party (e.g., &#39;classic heroes&#39;, &#39;villain masquerade&#39;, &#39;futuristic Gotham&#39;).&#34;</span>,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    output_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;string&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, category: str):
</span></span><span style="display:flex;"><span>        themes <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;classic heroes&#34;</span>: <span style="color:#e6db74">&#34;Justice League Gala: Guests come dressed as their favorite DC heroes with themed cocktails like &#39;The Kryptonite Punch&#39;.&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;villain masquerade&#34;</span>: <span style="color:#e6db74">&#34;Gotham Rogues&#39; Ball: A mysterious masquerade where guests dress as classic Batman villains.&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;futuristic Gotham&#34;</span>: <span style="color:#e6db74">&#34;Neo-Gotham Night: A cyberpunk-style party inspired by Batman Beyond, with neon decorations and futuristic gadgets.&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> themes<span style="color:#f92672">.</span>get(category<span style="color:#f92672">.</span>lower(), <span style="color:#e6db74">&#34;Themed party idea not found. Try &#39;classic heroes&#39;, &#39;villain masquerade&#39;, or &#39;futuristic Gotham&#39;.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Alfred, the butler, preparing the menu for the party</span>
</span></span><span style="display:flex;"><span>agent <span style="color:#f92672">=</span> CodeAgent(
</span></span><span style="display:flex;"><span>    tools<span style="color:#f92672">=</span>[
</span></span><span style="display:flex;"><span>        DuckDuckGoSearchTool(), 
</span></span><span style="display:flex;"><span>        VisitWebpageTool(),
</span></span><span style="display:flex;"><span>        suggest_menu,
</span></span><span style="display:flex;"><span>        catering_service_tool,
</span></span><span style="display:flex;"><span>        SuperheroPartyThemeTool(),
</span></span><span style="display:flex;"><span>	FinalAnswerTool()
</span></span><span style="display:flex;"><span>    ], 
</span></span><span style="display:flex;"><span>    model<span style="color:#f92672">=</span>InferenceClientModel(),
</span></span><span style="display:flex;"><span>    max_steps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>    verbosity_level<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>agent<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#34;Give me the best playlist for a party at the Wayne&#39;s mansion. The party idea is a &#39;villain masquerade&#39; theme&#34;</span>)
</span></span></code></pre></div><p>使用  OpenTelemetry and Langfuse 检测</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># !pip install smolagents[telemetry] \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># opentelemetry-sdk \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># opentelemetry-exporter-otlp \</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># openinference-instrumentation-smolagents</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> google.colab <span style="color:#f92672">import</span> userdata
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LANGFUSE_PUBLIC_KEY<span style="color:#f92672">=</span>userdata<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;LANGFUSE_PUBLIC_KEY&#34;</span>)
</span></span><span style="display:flex;"><span>LANGFUSE_SECRET_KEY<span style="color:#f92672">=</span>userdata<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;LANGFUSE_SECRET_KEY&#34;</span>)
</span></span><span style="display:flex;"><span>LANGFUSE_AUTH<span style="color:#f92672">=</span>base64<span style="color:#f92672">.</span>b64encode(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>LANGFUSE_PUBLIC_KEY<span style="color:#e6db74">}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{</span>LANGFUSE_SECRET_KEY<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;OTEL_EXPORTER_OTLP_ENDPOINT&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://cloud.langfuse.com/api/public/otel&#34;</span> <span style="color:#75715e"># EU data region</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># os.environ[&#34;OTEL_EXPORTER_OTLP_ENDPOINT&#34;] = &#34;https://us.cloud.langfuse.com/api/public/otel&#34; # US data region</span>
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;OTEL_EXPORTER_OTLP_HEADERS&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Authorization=Basic </span><span style="color:#e6db74">{</span>LANGFUSE_AUTH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> smolagents <span style="color:#f92672">import</span> CodeAgent, InferenceClientModel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>agent <span style="color:#f92672">=</span> CodeAgent(tools<span style="color:#f92672">=</span>[], model<span style="color:#f92672">=</span>InferenceClientModel())
</span></span><span style="display:flex;"><span>alfred_agent <span style="color:#f92672">=</span> agent<span style="color:#f92672">.</span>from_hub(<span style="color:#e6db74">&#39;sergiopaniego/AlfredAgent&#39;</span>, trust_remote_code<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>alfred_agent<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#34;Give me best playlist for a party at the Wayne&#39;s mansion. The party idea is a &#39;villain masquerade&#39; theme&#34;</span>)
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ashburnLee.github.io/blog-2-hugo/tags/agent/">Agent</a></li>
      <li><a href="https://ashburnLee.github.io/blog-2-hugo/tags/smolagents/">Smolagents</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://ashburnLee.github.io/blog-2-hugo/">Junhui&#39;s Journal 2</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
